/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import{Command as _0x4397a4}from'ckeditor5/src/core';import{getStyles as _0x414fc5,getConverterOptions as _0x58615a}from'./utils';export default class i extends _0x4397a4{constructor(_0x4e6482){super(_0x4e6482),this['set']('isBusy',!0x1),this['affectsData']=!0x1;}['refresh'](){this['isEnabled']=!this['isBusy'],this['value']=this['isBusy']?'pending':void 0x0;}['execute'](_0x540c2e={}){const _0x7d2c1b=this['editor'],t=_0x7d2c1b['t'],_0x50fdeb=_0x540c2e['converterUrl']||'https://docx-converter.cke-cs.com/v1/convert',_0x59e910=_0x540c2e['converterOptions']||{},_0x3a7d56=_0x7d2c1b['plugins']['get']('ExportWord'),_0x1d38df=_0x540c2e['token']||_0x3a7d56['_token'],_0x97e422=!0x1!==_0x59e910['auto_pagination'],_0x2cc28c=_0x540c2e['dataCallback']||(_0x526bf5=>_0x526bf5['getData']({'pagination':_0x97e422}));return this['isBusy']=!0x0,this['refresh'](),_0x414fc5(_0x540c2e['stylesheets']||['EDITOR_STYLES'])['then'](_0xfb6785=>{const _0x2a0617=_0x2cc28c(_0x7d2c1b),_0x281144={'html':'<div\x20class=\x22ck-content\x22\x20dir=\x22'+_0x7d2c1b['locale']['contentLanguageDirection']+'\x22>'+_0x2a0617+'</div>','css':_0xfb6785,'options':{..._0x59e910,..._0x58615a(_0x7d2c1b)}},_0x3b086c={'method':'POST','headers':{'Content-Type':'application/json','Accept':'application/docx',..._0x1d38df?{'Authorization':_0x1d38df['value']}:null},'body':JSON['stringify'](_0x281144)};return window['fetch'](_0x50fdeb,_0x3b086c)['then'](_0xfe6b8d=>{if(0xc8!==_0xfe6b8d['status'])throw _0xfe6b8d;return _0xfe6b8d['blob']();})['then'](_0x363e5b=>{this['o'](_0x363e5b,_0x540c2e['fileName']||'document.docx');});})['catch'](_0x1a6ac3=>{throw _0x7d2c1b['plugins']['get']('Notification')['showWarning'](t('An\x20error\x20occurred\x20while\x20generating\x20the\x20Word\x20file.')),_0x1a6ac3;})['finally'](()=>{this['isBusy']=!0x1,this['refresh']();});}['o'](_0x148938,_0x336d47){const _0x3a39ad=document['createElement']('a');_0x3a39ad['href']=window['URL']['createObjectURL'](_0x148938),_0x3a39ad['download']=_0x336d47,_0x3a39ad['click'](),_0x3a39ad['remove']();}}